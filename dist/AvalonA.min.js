!function(){var t,e,i=function(t,e){return function(){return t.apply(e,arguments)}};t=function(){function t(t){var e,i,n,s;if(this.area=t,!this.area)throw new Error("area argument is missing");this.position=this.area.position||"auto","object"==typeof this.position&&(null==(n=(e=this.position).x)&&(e.x="auto"),null==(s=(i=this.position).y)&&(i.y="auto"),"auto"===this.position.x&&"auto"===this.position.y&&(this.position="auto")),this.attachment=this.area.attachment||"fixed",this.assertValid(),this.processActiveArea()}var e,i;return e=/^\d+(%|px)?$/gi,i=function(t){var i;return e.lastIndex=0,i=e.test(t),e.lastIndex=0,i},t.prototype.assertValid=function(){var t,e;if(t=["The following validation errors occured:"],"object"!=typeof this.position?"auto"!==this.position&&t.push("area.position is not valid ("+this.position+")"):("auto"===this.position.x||i(this.position.x)||t.push("area.position.x is not valid ("+this.position.x+"})"),"auto"===this.position.y||i(this.position.y)||t.push("area.position.y is not valid ("+this.position.y+"})")),"fixed"!==(e=this.attachment)&&"scroll"!==e&&t.push("area.attachment is not valid ("+this.attachment+")"),i(this.area.width)||t.push("area.width is not valid ("+this.area.width+")"),i(this.area.height)||t.push("area.height is not valid ("+this.area.height+")"),t.length>1)throw new Error(t.join("\n"))},t.prototype.processActiveArea=function(){var t,i,n,s,r;return this.width=parseInt(this.area.width,10),this.widthIsFluid="%"===e.exec(this.area.width)[1],e.lastIndex=0,this.height=parseInt(this.area.height,10),this.heightIsFluid="%"===e.exec(this.area.height)[1],e.lastIndex=0,"object"==typeof this.position&&("auto"!==this.position.x&&(this.x=parseInt(this.position.x,10)),"auto"!==this.position.y&&(this.y=parseInt(this.position.y,10))),i=this.getXBaseComputation(),s=this.getYBaseComputation(),t=this,"fixed"===this.attachment?(n=function(){return t.frame.prop("scrollLeft")},r=function(){return t.frame.prop("scrollTop")}):n=r=function(){return 0},this.xMin=function(){return i()+n()},this.yMin=function(){return s()+r()},this.xMax=this.widthIsFluid?function(){return this.xMin()+this.width/100*this.frame.width()}:function(){return this.xMin()+this.width},this.yMax=this.heightIsFluid?function(){return this.yMin()+this.height/100*this.frame.height()}:function(){return this.yMin()+this.height}},t.prototype.getXBaseComputation=function(){var t,i;return t=this,this.position.x&&"auto"!==this.position.x?(i="%"===e.exec(this.position.x)[1]?function(){return t.x/100*t.frame.width()}:function(){return t.x},e.lastIndex=0):i=this.widthIsFluid?function(){return(50-t.width/2)/100*t.frame.width()}:function(){return t.frame.width()/2-t.width/2},i},t.prototype.getYBaseComputation=function(){var t,i;return t=this,this.position.y&&"auto"!==this.position.y?(i="%"===e.exec(this.position.y)[1]?function(){return t.y/100*t.frame.height()}:function(){return t.y},e.lastIndex=0):i=this.heightIsFluid?function(){return(50-t.height/2)/100*t.frame.height()}:function(){return t.frame.height()/2-t.height/2},i},t.prototype.mouseover=function(t){var e,i;return this.xMin()<=(e=t.pageX)&&e<=this.xMax()&&this.yMin()<=(i=t.pageY)&&i<=this.yMax()},t.prototype.bounds=function(){return{xMin:this.xMin(),xMax:this.xMax(),yMin:this.yMin(),yMax:this.yMax()}},t}(),e=function(){function e(t,e){this.id=t,null==e&&(e={}),this.zRefreshChild=i(this.zRefreshChild,this),this.debug=e.debug,s(),this.debug===!0&&console.log("transformStyleIsSupported: "+o),o?this.init(e):this.refresh=this.setZOf=this.zRefreshChild=this.zRefresh=this.untrackMouseMovements=this.trackMouseMovements=this.setPerspective=function(){}}var n,s,r,o,a;return a=.75,r=function(t){return t},o=null,s=function(){var t,e,i,n,s,r,a,h,u;return null===o&&(n="avalona-detection-element",t=$("body").prepend("<b id='"+n+"' style='position:absolute; top:0; left:0;'></b>"),i=$("#"+n),null!=(r=i[0].style)&&(r.webkitTransformStyle="preserve-3d"),null!=(a=i[0].style)&&(a.MozTransformStyle="preserve-3d"),null!=(h=i[0].style)&&(h.msTransformStyle="preserve-3d"),null!=(u=i[0].style)&&(u.transformStyle="preserve-3d"),e=getComputedStyle(i[0],null),s=e.getPropertyValue("-webkit-transform-style")||e.getPropertyValue("-moz-transform-style")||e.getPropertyValue("-ms-transform-style")||e.getPropertyValue("transform-style"),o="preserve-3d"===s,i.remove()),o},n=function(t){return""+t.prop("tagName")+"("+(t.attr("id")||t.attr("class")||t.attr("href"))+")"},e.prototype.find3dFrames=function(){if(this.outerFrameJQueryNode=$("#"+this.id),this.innerFrameJQueryNode=$("."+this.cssClass,this.outerFrameJQueryNode).eq(0),this.debug===!0&&(console.log("@deepnessAttribute: "+this.deepnessAttribute),console.log("@cssClass: "+this.cssClass)),!this.outerFrameJQueryNode.size())throw new Error("Cannot find 3d frame '#"+this.id+"' in dom");if(!this.innerFrameJQueryNode.size())throw new Error("Cannot find 3d inner frame '#"+this.id+" ."+this.cssClass+"' in dom")},e.prototype.setPerspective=function(){return TweenLite.set(this.innerFrameJQueryNode[0],{transformPerspective:1e3})},e.prototype.trackMouseMovements=function(){var t,e,i,n,s=this;return this.debug===!0?($("body").append("<div id='avalona-active-area' style='background-color:hotpink;opacity:0.75;pointer-events:none;position:absolute;visibility:hidden;z-index:10000;'>AvalonA Active Area</div>"),t=$("#avalona-active-area"),n=this,e=function(e,i){var s;return console.log("rotationX: "+e+", rotationY: "+i),s=n.activeArea.bounds(),t.css({visibility:"visible",left:""+s.xMin+"px",top:""+s.yMin+"px",width:""+(s.xMax-s.xMin)+"px",height:""+(s.yMax-s.yMin)+"px"})}):e=function(){},this.activeArea?this.activeArea.frame=this.outerFrameJQueryNode:this.outerFrameJQueryNode.on("mouseout","#"+this.id,function(){return s.cancelRotation()}),i=0,this.outerFrameJQueryNode.mousemove(function(t){var n,r;if(!(++i%5>0))return!s.activeArea||s.activeArea.mouseover(t)?(r=(t.pageX-$(window).prop("innerWidth")/2)/25,n=-1*(t.pageY-$(window).prop("innerHeight")/2)/15,e(n,r),TweenLite.to(s.innerFrameJQueryNode[0],.1,{rotationX:s.fy(n),rotationY:s.fx(r)})):s.cancelRotation()})},e.prototype.cancelRotation=function(){return TweenLite.to(this.innerFrameJQueryNode[0],1,{rotationX:0,rotationY:0})},e.prototype.untrackMouseMovements=function(){var t,e;return null!=(t=this.outerFrameJQueryNode)&&t.off("mousemove"),null!=(e=this.outerFrameJQueryNode)?e.off("mouseout"):void 0},e.prototype.zRefresh=function(t){var e,i,s;return null==t&&(t=null),i=this,null==t&&(t=this.innerFrameJQueryNode),s="string"==typeof t?$(s,this.innerFrameJQueryNode):$(t),this.debug===!0&&console.log("target: "+n(s)),this.setZOf(s),e=s.children().eq(0),this.debug===!0&&console.log("zRefresh firstChild: "+n(e)),this.zRefreshChild(e).siblings().each(function(){return i.zRefreshChild($(this))})},e.prototype.zRefreshChild=function(t){if(!t)throw new Error("zRefreshChild child argument cannot be null");return $("["+this.deepnessAttribute+"]",t).length?(this.debug===!0&&console.log("zRefresh child "+n(t)+" has children"),this.zRefresh(t)):t.attr(this.deepnessAttribute)&&(this.debug===!0&&console.log("zRefresh child "+n(t)+" has '"+this.deepnessAttribute+"'"),this.setZOf(t)),t},e.prototype.setZOf=function(t){var e;if(!t)throw new Error("setZOf target argument cannot be null");return TweenLite.set(t[0],{transformStyle:"preserve-3d",overflow:"visible"}),e=t.attr(this.deepnessAttribute),e?TweenLite.to(t[0],a,{z:e}):void 0},e.prototype.refresh=function(){return this.untrackMouseMovements(),this.find3dFrames(),this.setPerspective(),this.zRefresh(),this.trackMouseMovements()},e.prototype.start=function(){return this.refresh()},e.prototype.init=function(e){var i;return this.deepnessAttribute=e.zAttr||"data-avalonA-deepness",this.cssClass=e["class"]||"avalona-inner-frame",this.fx="function"==typeof e.fx?e.fx:r,this.fy="function"==typeof e.fy?e.fy:r,e.activeArea&&(this.activeArea=new t(e.activeArea)),null!=(i=this.activeArea)?i.debug=this.debug:void 0},e}(),window.AvalonA=function(t,i){return null==i&&(i=!1),new e(t,i)}}.call(this);
;