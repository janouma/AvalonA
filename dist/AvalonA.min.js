!function(){var t,i,o=function(t,i){return function(){return t.apply(i,arguments)}};console.log("%cAvalonA 0.10.1","font-size:80%;padding:0.2em 0.5em;color:#FFFFD5;background-color:#FF0066;"),t=function(t,i){var e,n;return e=function(){function i(t){var i,o;if(this.area=t,!this.area)throw new Error("area argument is missing");this.position=this.area.position||"auto","object"==typeof this.position&&(null==(i=this.position).x&&(i.x="auto"),null==(o=this.position).y&&(o.y="auto"),"auto"===this.position.x&&"auto"===this.position.y&&(this.position="auto")),this.attachment=this.area.attachment||"fixed",this.assertValid(),this.processActiveArea()}var o,e;return o=/^\d+(%|px)?$/gi,e=function(t){var i;return o.lastIndex=0,i=o.test(t),o.lastIndex=0,i},i.prototype.assertValid=function(){var t,i;if(t=["The following validation errors occured:"],"object"!=typeof this.position?"auto"!==this.position&&t.push("area.position is not valid ("+this.position+")"):("auto"===this.position.x||e(this.position.x)||t.push("area.position.x is not valid ("+this.position.x+"})"),"auto"===this.position.y||e(this.position.y)||t.push("area.position.y is not valid ("+this.position.y+"})")),"fixed"!==(i=this.attachment)&&"scroll"!==i&&t.push("area.attachment is not valid ("+this.attachment+")"),e(this.area.width)||t.push("area.width is not valid ("+this.area.width+")"),e(this.area.height)||t.push("area.height is not valid ("+this.area.height+")"),t.length>1)throw new Error(t.join("\n"))},i.prototype.processActiveArea=function(){return this.width=parseInt(this.area.width,10),this.widthIsFluid="%"===o.exec(this.area.width)[1],o.lastIndex=0,this.height=parseInt(this.area.height,10),this.heightIsFluid="%"===o.exec(this.area.height)[1],o.lastIndex=0,"object"==typeof this.position&&("auto"!==this.position.x&&(this.x=parseInt(this.position.x,10)),"auto"!==this.position.y)?this.y=parseInt(this.position.y,10):void 0},i.prototype.init=function(i){var o,e,n,r,s,a,h,u=this;if(this.frame=i,!this.frame)throw new Error("frame argument cannot be null");return this.xBase=(a=this.getXBaseComputation())(),this.yBase=(h=this.getYBaseComputation())(),this.xMaxComputation=this.widthIsFluid?function(){return this.xMin+this.width/100*this.frame.width()}:function(){return this.xMin+this.width},this.yMaxComputation=this.heightIsFluid?function(){return this.yMin+this.height/100*this.frame.height()}:function(){return this.yMin+this.height},"fixed"===this.attachment?(this.xPadding=this.frame.prop("scrollLeft"),this.yPadding=this.frame.prop("scrollTop"),this.debug===!0?(console.log("Listen to scroll event"),r=this,n=function(){return console.log("Scroll : @xPadding = "+r.xPadding+", @yPadding = "+r.yPadding)}):n=function(){},s=0,t(window).scroll(function(){return++s%5>0?void 0:(u.xPadding=t(window).prop("pageXOffset"),u.yPadding=t(window).prop("pageYOffset"),u.refreshBounds(),n())}),o=0,this.frame.scroll(function(){return++o%5>0?void 0:(u.xPadding=u.frame.prop("scrollLeft"),u.yPadding=u.frame.prop("scrollTop"),u.refreshBounds(),n())})):this.xPadding=this.yPadding=0,this.debug===!0?(r=this,e=function(){return console.log("Resize : @frame.width() = "+r.frame.width()+", @frame.height() = "+r.frame.height())}):e=function(){},t(window).resize(function(){return u.xBase=a(),u.yBase=h(),u.refreshBounds(),e()}),this.refreshBounds()},i.prototype.refreshBounds=function(){return this.xMin=this.xBase+this.xPadding,this.xMax=this.xMaxComputation(),this.yMin=this.yBase+this.yPadding,this.yMax=this.yMaxComputation()},i.prototype.bounds=function(){return{xMin:this.xMin,xMax:this.xMax,yMin:this.yMin,yMax:this.yMax}},i.prototype.getXBaseComputation=function(){var t,i=this;return this.position.x&&"auto"!==this.position.x?(t="%"===o.exec(this.position.x)[1]?function(){return i.x/100*i.frame.width()}:function(){return i.x},o.lastIndex=0):t=this.widthIsFluid?function(){return(50-i.width/2)/100*i.frame.width()}:function(){return i.frame.width()/2-i.width/2},t},i.prototype.getYBaseComputation=function(){var t,i=this;return this.position.y&&"auto"!==this.position.y?(t="%"===o.exec(this.position.y)[1]?function(){return i.y/100*i.frame.height()}:function(){return i.y},o.lastIndex=0):t=this.heightIsFluid?function(){return(50-i.height/2)/100*i.frame.height()}:function(){return i.frame.height()/2-i.height/2},t},i.prototype.mouseover=function(t){var i,o;return this.xMin<=(i=t.pageX)&&i<=this.xMax&&this.yMin<=(o=t.pageY)&&o<=this.yMax},i}(),n=function(){function n(t,i,e){if(this.frameId=t,this.layerId=i,null==e&&(e={}),this.refreshChildTransform=o(this.refreshChildTransform,this),this.stopRotation=o(this.stopRotation,this),this.mousemove=o(this.mousemove,this),this.mouseout=o(this.mouseout,this),!this.frameId)throw new Error("frameId argument cannot be null");if(!this.layerId)throw new Error("layerId argument cannot be null");this.debug=e.debug,a(),this.debug===!0&&console.log("transformStyleIsSupported: "+f),f?this.init(e):this.flatten=this.disableRotationEvent=this.disable=this.start=this.enable=this.refresh=this.applyTransformOn=this.refreshChildTransform=this.refreshTransform=this.untrackMouseMovements=this.trackMouseMovements=this.addPerspective=this.removePerspective=function(){}}var r,s,a,h,u,f,l;return l=.75,u=function(t){return t},f=null,r="data-css-backup",a=function(){var i,o,e,n,r,s,a;return null===f&&(e="avalona-detection-element",i=t("body").prepend("<b id='"+e+"' style='position:absolute; top:0; left:0;'></b>"),o=t("#"+e),null!=(n=o[0].style)&&(n.webkitTransformStyle="preserve-3d"),null!=(r=o[0].style)&&(r.MozTransformStyle="preserve-3d"),null!=(s=o[0].style)&&(s.msTransformStyle="preserve-3d"),null!=(a=o[0].style)&&(a.transformStyle="preserve-3d"),f="preserve-3d"===h(o[0]),o.remove()),f},h=function(t){var i;return i=getComputedStyle(t,null),i.getPropertyValue("-webkit-transform-style")||i.getPropertyValue("-moz-transform-style")||i.getPropertyValue("-ms-transform-style")||i.getPropertyValue("transform-style")},s=function(t){return""+t.prop("tagName")+"("+(t.attr("id")||t.attr("class")||t.attr("href"))+")"},n.prototype.find3dFrames=function(){if(this.frame=t("#"+this.frameId),this.transformedLayer=t("#"+this.layerId,this.frame),this.debug===!0&&(console.log("@transformAttribute: "+this.transformAttribute),console.log("@layerId: "+this.layerId)),!this.frame.size())throw new Error("Cannot find 3d frame '#"+this.frameId+"' in dom");if(!this.transformedLayer.size())throw new Error("Cannot find 3d inner frame '#"+this.frameId+" > #"+this.layerId+"' in dom")},n.prototype.addPerspective=function(){return i.set(this.transformedLayer[0],{css:{perspective:1e3}})},n.prototype.removePerspective=function(){return i.set(this.transformedLayer[0],{css:{perspective:"none"}})},n.prototype.trackMouseMovements=function(){var i;return this.debug===!0&&this.activeArea?(t("body").append("<div id='avalona-active-area' style='background-color:hotpink;opacity:0.75;pointer-events:none;position:absolute;visibility:hidden;z-index:10000;'>AvalonA Active Area</div>"),i=t("#avalona-active-area"),this.debugMouseMove=function(){var t;return console.log("rotationX: "+this.rotationX+", rotationY: "+this.rotationY),t=this.activeArea.bounds(),i.css({visibility:"visible",left:""+t.xMin+"px",top:""+t.yMin+"px",width:""+(t.xMax-t.xMin)+"px",height:""+(t.yMax-t.yMin)+"px"})}):this.debugMouseMove=function(){},this.activeArea?this.activeArea.init(this.frame):this.frame.on("mouseleave","#"+this.frameId,this.mouseout),this.frame.mousemove(this.mousemove)},n.prototype.mouseout=function(){return this.disableRotation()},n.prototype.mouseMoveCount=0,n.prototype.mousemove=function(o){return++this.mouseMoveCount%5>0?void 0:!this.activeArea||this.activeArea.mouseover(o)?(this.onrotation(),this.rotationY=(o.pageX-t(window).prop("innerWidth")/2)/25,this.rotationX=-1*(o.pageY-t(window).prop("innerHeight")/2)/15,this.debugMouseMove(),i.to(this.transformedLayer[0],.1,{css:{rotationX:this.fy(this.rotationX),rotationY:this.fx(this.rotationY)}})):this.disableRotation()},n.prototype.onrotation=function(){var t;return clearTimeout(this.rotationTimeoutId),this.rotating||(null!=(t=this.animation)&&t.pause(),"function"==typeof this.onstartrotation&&this.onstartrotation(),this.rotating=!0),this.idleTimeout>0?this.rotationTimeoutId=setTimeout(this.stopRotation,this.idleTimeout):void 0},n.prototype.stopRotation=function(){var t;return clearTimeout(this.rotationTimeoutId),this.rotating?(this.rotating=!1,"function"==typeof this.onendrotation&&this.onendrotation(),null!=(t=this.animation)?t.play():void 0):void 0},n.prototype.disableRotation=function(t){return null==t&&(t=1),(this.rotationX||this.rotationY)&&null==this.animation&&this.resetRotation(t),this.stopRotation()},n.prototype.resetRotation=function(t){return null==t&&(t=1),clearTimeout(this.rotationTimeoutId),this.rotationX=this.rotationY=0,i.to(this.transformedLayer[0],t,{css:{rotationX:0,rotationY:0}})},n.prototype.resetTransform=function(){return clearTimeout(this.rotationTimeoutId),this.rotationX=this.rotationY=0,this.transformedLayer.css({"-webkit-transform":"none","-moz-transform":"none","-o-transform":"none","-ms-transform":"none",transform:"none"})},n.prototype.untrackMouseMovements=function(){var t,i;return null!=(t=this.frame)&&t.off("mousemove",this.mousemove),null!=(i=this.frame)?i.off("mouseleave",this.mouseout):void 0},n.prototype.refreshTransform=function(i){var o,e,n;return null==i&&(i=null),this.disabled!==!0?(e=this,null==i&&(i=this.transformedLayer),n="string"==typeof i?t(i,this.transformedLayer):t(i),this.debug===!0&&console.log("target: "+s(n)),this.applyTransformOn(n),o=n.children().eq(0),this.debug===!0&&console.log("refreshTransform firstChild: "+s(o)),this.refreshChildTransform(o).siblings().each(function(){return e.refreshChildTransform(t(this))})):void 0},n.prototype.refreshChildTransform=function(i){if(!i)throw new Error("refreshChildTransform child argument cannot be null");return t("["+this.transformAttribute+"]",i).length?(this.debug===!0&&console.log("refreshTransform child "+s(i)+" has children"),this.refreshTransform(i)):i.attr(this.transformAttribute)&&(this.debug===!0&&console.log("refreshTransform child "+s(i)+" has '"+this.transformAttribute+"'"),this.applyTransformOn(i)),i},n.prototype.applyTransformOn=function(t){var o,e,n,s,a,u,f,d,p,m,c,y,v,g,x,w;if(!t)throw new Error("applyTransformOn target argument cannot be null");if(t.attr(r)||(e={transformStyle:h(t[0])||"flat",overflow:t.css("overflow")||"inherit"},p=t.css("-webkit-transform")||t.css("-moz-transform")||t.css("-o-transform")||t.css("-ms-transform")||t.css("transform"),p&&(e.transform=p),t.attr(r,JSON.stringify(e))),i.set(t[0],{css:{transformStyle:"preserve-3d",overflow:"visible"}}),o=t.attr(this.transformAttribute)){for(m={},x=o.split(";"),v=0,g=x.length;g>v;v++)d=x[v],w=d.split(":"),s=w[0],c=w[1],m[s.trim()]=parseInt(c.trim(),10);if(y=m.z,a=m.rx,u=m.ry,f=m.rz,y||a||u||f)return n={},y&&(n.z=y),a&&(n.rotationX=a),u&&(n.rotationY=u),f&&(n.rotationZ=f),i.to(t[0],l,{css:n})}},n.prototype.refresh=function(){var t,i;return this.disabled=!1,this.frame&&(this.untrackMouseMovements(),null!=(t=this.animation)&&t.pause()),this.find3dFrames(),this.addPerspective(),this.refreshTransform(),this.trackMouseMovements(),null!=(i=this.animation)?i.play(this.transformedLayer[0]):void 0},n.prototype.start=function(){return this.refresh()},n.prototype.enable=function(){return this.refresh()},n.prototype.disable=function(){var t;return this.frame&&(this.untrackMouseMovements(),this.disableRotationEvent(),null!=(t=this.animation)&&t.pause(),this.flatten(),this.removePerspective()),this.disabled=!0},n.prototype.disableRotationEvent=function(){return clearTimeout(this.rotationTimeoutId),this.rotating=!1,"function"==typeof this.onendrotation?this.onendrotation():void 0},n.prototype.flatten=function(){var o;return this.resetTransform(),o=this,t("["+r+"]",this.transformedLayer[0]).each(function(){var e;return o.debug===!0&&console.log("flattening layer '"+s(t(this))+"'"),e=JSON.parse(t(this).attr(r)),i.set(this,{css:e})})},n.prototype.init=function(t){var i,o,n;return this.transformAttribute=t.tAttr||"data-avalonA-transform",this.fx="function"==typeof t.fx?t.fx:u,this.fy="function"==typeof t.fy?t.fy:u,t.activeArea&&(this.activeArea=new e(t.activeArea)),null!=(i=this.activeArea)&&(i.debug=this.debug),this.onstartrotation=null!=(o=t.on)?o.startrotation:void 0,this.onendrotation=null!=(n=t.on)?n.endrotation:void 0,this.animation=t.animation,this.idleTimeout=parseInt(t.idleTimeout||1e3,10),this.animation?this.assertAnimatorValid():void 0},n.prototype.assertAnimatorValid=function(){if(!this.animation.play||"function"!=typeof this.animation.play)throw new Error("animation.play must be a function");if(!this.animation.pause||"function"!=typeof this.animation.pause)throw new Error("animation.pause must be a function")},n}(),function(t,i,o){return null==o&&(o=!1),new n(t,i,o)}},"function"==typeof define&&define.amd?define("AvalonA",["jquery","tweenlite"],function(i,o){return t(i,o)}):window.AvalonA=t($,(null!=(i=window.GreenSockGlobals)?i.TweenLite:void 0)||TweenLite)}.call(this);
;